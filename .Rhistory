filter(INDICATEUR=="CNA_PIB", PRIX_REF =="VAL") |>
pull(idbank) |>
get_insee_idbank() |>
mutate(year = TIME_PERIOD,
pib = OBS_VALUE) |>
select(year, pib) |>
arrange(year) |>
mutate(g = pib/lag(pib)-1,
g2 = (lag(pib)/lag(pib, 6))^(1/5)-1)
interets <- apu |>
filter(OPERATION %in%c("D41", "B9NF"), SECT_INST == "S13") |>
pull(idbank) |>
get_insee_idbank() |>
mutate(year = TIME_PERIOD) |>
left_join(pib, by="year") |>
mutate(interets = OBS_VALUE/pib,
year = TIME_PERIOD) |>
select(year, interets, pib, g, g2, IDBANK) |>
mutate(type = case_when(
IDBANK=="010563497" ~ "verses",
IDBANK=="010563498" ~ "recus",
IDBANK=="010563277" ~ "cf"),
year = as.numeric(year)) |>
select(-IDBANK) |>
pivot_wider(names_from = type, values_from = interets) |>
mutate(defp = -cf - verses,
time = lubridate::ym(str_c(year, " 01")))
ids <- get_idbank_list("CNA-2014-DETTE-APU") |>
filter(SECT_INST == "S13", PRIX_REF =="PCT_PIB") |>
pull(idbank, name=INDICATEUR)
dette <- 	ids |>
get_insee_idbank() |>
mutate(IDBANK = names(ids)[map_int(IDBANK, ~which(.x==ids))]) |>
select(year = TIME_PERIOD,
dette = OBS_VALUE,
var = IDBANK) |>
mutate(var = str_remove(var, "CNA_FINANCES_")) |>
pivot_wider(names_from = var, values_from = dette) |>
rename(dette = DETTE, dette_nette = DETTENETTE, deficit = DEFICIT) |>
left_join(pib, by="year") |>
mutate(dstar = g2/(1+g2)*dette/100,
year = as.numeric(year),
time = lubridate::ym(str_c(year, " 01")))
# dette historique de la France, source FMI (https://www.imf.org/external/pubs/ft/wp/2010/wp10245.pdf & https://data.imf.org/?sk=806ED027-520D-497F-9052-63EC199F5E63)
HPDD <- read_csv("HPDD_04-26-2020 18-59-27-12.csv") |>
janitor::clean_names() |>
rename(year=time_period, dette_IMF=value, country = country_name) |>
filter(country=="France") |>
full_join(dette, by="year") |>
full_join(interets |> select(cf, verses, recus, defp, year), by="year") |>
arrange(year) |>
left_join(taux.a, by="year") |>
mutate(rapp2=verses*100/dette_IMF,
rapp1=verses*100/dette,
time = ym(str_c(year," 01")),
ec_app = if_else(year<1978, rapp2-g2, rapp1-g2),
ec_app_p = if_else(ec_app>=0, ec_app, NA_real_),
ec_app_m  = if_else(ec_app<0, ec_app, NA_real_),
ec = r/100-g2,
ec_p = if_else(ec>=0, ec, NA_real_),
ec_m  = if_else(ec<0, ec, NA_real_))
taux <- left_join(taux, interets |> select(-time), by=c("y"="year"))
gdette <- ggplot(HPDD |> filter(year>=1949))+
geom_step(data=~filter(.x,year<1978),aes(x=time, y=dette_IMF), color="dodgerblue4", direction="mid")+
geom_step(aes(x=time, y=dette), col="dodgerblue1", direction="mid")+
ylim(c(0,120))+
geom_segment(aes(y=0, yend=0, x=ym("1949 01"), xend=ym("1977 01")), size=0.1, col="grey25")+
geom_segment(aes(y=0, yend=1, x=ym("1949 01"), xend=ym("1949 01")), size=0.1, col="grey25")+
geom_segment(aes(y=0, yend=1, x=ym("1977 01"), xend=ym("1977 01")), size=0.1, col="grey25")+
annotate(geom="text", y=1, x=ym("1949 2"), label = "IMF historical public debt database", hjust=0, vjust = 0, size=1.5)+
geom_segment(aes(y=0, yend=0, x=ym("1978 01"), xend=ym("2020 12")), size=0.1, col="grey25")+
geom_segment(aes(y=0, yend=1, x=ym("1978 01"), xend=ym("1978 01")), size=0.1, col="grey25")+
geom_segment(aes(y=0, yend=1, x=ym("2020 12"), xend=ym("2020 12")), size=0.1, col="grey25")+
annotate(geom="text", y=1, x=ym("1978 2"), label = "CN 2020 INSEE", hjust=0, vjust = 0, size=1.5)+
scale_x_date(date_breaks = "10 years", date_labels = "%Y", limits=c(ym("1949 01"), ym("2021 12")))+
labs(title="Dette publique en % du PIB")
gtaux <- ggplot(taux |> filter(y>=1949))+
geom_step(data=~filter(.x, y>= 1987), aes(x=time, y=r10ans), col="dodgerblue1", direction="mid")+
geom_step(data=~filter(.x, y<1987),aes(x=time, y=r_frig), col="dodgerblue4", direction="mid")+
geom_segment(aes(y=0, yend=0, x=ym("1949 01"), xend=ym("1987 01")), size=0.1, col="grey25")+
geom_segment(aes(y=0, yend=0.1, x=ym("1949 01"), xend=ym("1949 01")), size=0.1, col="grey25")+
geom_segment(aes(y=0, yend=0.1, x=ym("1987 01"), xend=ym("1987 01")), size=0.1, col="grey25")+
annotate(geom="text", y=0.1, x=ym("1949 2"), label = "CN 2020 INSEE et CGEDD J.Friggit", hjust=0, vjust = 0, size=1.5)+
geom_segment(aes(y=0, yend=0, x=ym("1987 01"), xend=ym("2021 11")), size=0.1, col="grey25")+
geom_segment(aes(y=0, yend=.1, x=ym("1987 01"), xend=ym("1987 01")), size=0.1, col="grey25")+
geom_segment(aes(y=0, yend=.1, x=ym("2021 11"), xend=ym("2021 11")), size=0.1, col="grey25")+
annotate(geom="text", y=0.1, x=ym("1988 2"), label = "CN 2020 INSEE", hjust=0, vjust = 0, size=1.5)+
scale_x_date(date_breaks = "10 years", date_labels = "%Y", limits=c(ym("1949 01"), ym("2021 12")))+
labs(title="Taux souverain (10 ans, en %/an)")
gcharge <- ggplot(interets)+
geom_step(aes(x=time, y=100*verses), col="dodgerblue1", direction="mid")+
geom_segment(aes(y=0, yend=0, x=ym("1949 01"), xend=ym("2020 12")), size=0.1, col="grey25")+
geom_segment(aes(y=0, yend=0.05, x=ym("1949 01"), xend=ym("1949 01")), size=0.1, col="grey25")+
geom_segment(aes(y=0, yend=0.05, x=ym("2020 12"), xend=ym("2020 12")), size=0.1, col="grey25")+
annotate(geom="text", y=0.05, x=ym("1949 2"), label = "CN 2020 INSEE", hjust=0, vjust = 0, size=1.5)+
scale_x_date(date_breaks = "10 years", date_labels = "%Y", limits=c(ym("1949 01"), ym("2021 12")))+
ylim(c(0,4))+
labs(title="Charge d'intérêts en % du PIB")
gecartc <- ggplot(HPDD |> filter(year>=1949))+
geom_step(data=~filter(.x,year<1987),aes(x=time, y=100*ec), color="dodgerblue4", direction="mid")+
geom_step(data=~filter(.x,year>=1987),aes(x=time, y=100*ec), color="dodgerblue1", direction="mid")+
geom_col(aes(x=time, y=100*ec_p), fill="red", alpha=0.1, col=NA, width=years(1)/days(1),)+
geom_col(aes(x=time, y=100*ec_m), fill="green", alpha=0.1, width=years(1)/days(1), col=NA)+
geom_segment(aes(y=0, yend=0, x=ym("1949 01"), xend=ym("1986 01")), size=0.1, col="grey25")+
geom_segment(aes(y=0, yend=0.1, x=ym("1949 01"), xend=ym("1949 01")), size=0.1, col="grey25")+
geom_segment(aes(y=0, yend=0.1, x=ym("1986 01"), xend=ym("1986 01")), size=0.1, col="grey25")+
annotate(geom="text", y=0.1, x=ym("1949 2"), label = "CN 2020 INSEE et CGEDD J.Friggit", hjust=0, vjust = 0, size=1.5)+
geom_segment(aes(y=0, yend=0, x=ym("1987 01"), xend=ym("2020 01")), size=0.1, col="grey25")+
geom_segment(aes(y=0, yend=.1, x=ym("1987 01"), xend=ym("1987 01")), size=0.1, col="grey25")+
geom_segment(aes(y=0, yend=.1, x=ym("2020 01"), xend=ym("2020 01")), size=0.1, col="grey25")+
annotate(geom="text", y=-0.1, x=ym("1988 2"), label = "CN 2020 INSEE", hjust=0, vjust = 1, size=1.5)+
scale_x_date(date_breaks = "10 years", date_labels = "%Y", limits=c(ym("1949 01"), ym("2021 12")))+
labs(title="r - g (en %/an)")
g_altereco <- (gdette + gtaux)/(gecartc+gcharge) +
plot_annotation(caption="Sources: INSEE, Banque de France, FMI, J. Friggit/CGEDD \n code: github.com/OFCE/AE_11-21") &
ylab("") &
xlab("") &
theme_minimal(base_family = "sans") &
theme(plot.title = element_text(size=10, face = "plain", hjust = 0.5),
plot.caption = element_text(size=7, face = "plain", hjust = 0),
axis.text =  element_text(size=7),
panel.grid.major = element_line(color="grey90", size=0.25),
panel.grid.minor = element_line(color="grey90", size=0.25))
ggsave(plot=g_altereco, filename="altereco.svg", width = 180, height = 180, units = "mm")
(gecartc <- ggplot(HPDD |> filter(year>=1949))+
geom_step(data=~filter(.x,year<1987),aes(x=time, y=100*ec), color="dodgerblue4", direction="mid")+
geom_step(data=~filter(.x,year>=1987),aes(x=time, y=100*ec), color="dodgerblue1", direction="mid")+
geom_col(aes(x=time, y=100*ec_p), fill="red", alpha=0.1, col=NA, width=years(1)/days(1),)+
geom_col(aes(x=time, y=100*ec_m), fill="green", alpha=0.1, width=years(1)/days(1), col=NA)+
geom_segment(aes(y=0, yend=0, x=ym("1949 01"), xend=ym("1986 01")), size=0.1, col="grey25")+
geom_segment(aes(y=0, yend=0.1, x=ym("1949 01"), xend=ym("1949 01")), size=0.1, col="grey25")+
geom_segment(aes(y=0, yend=0.1, x=ym("1986 01"), xend=ym("1986 01")), size=0.1, col="grey25")+
annotate(geom="text", y=0.1, x=ym("1949 2"), label = "CN 2020 INSEE et CGEDD J.Friggit", hjust=0, vjust = 0, size=1.5)+
geom_segment(aes(y=0, yend=0, x=ym("1987 01"), xend=ym("2020 01")), size=0.1, col="grey25")+
geom_segment(aes(y=0, yend=.1, x=ym("1987 01"), xend=ym("1987 01")), size=0.1, col="grey25")+
geom_segment(aes(y=0, yend=.1, x=ym("2020 01"), xend=ym("2020 01")), size=0.1, col="grey25")+
annotate(geom="text", y=-0.1, x=ym("1988 2"), label = "CN 2020 INSEE", hjust=0, vjust = 1, size=1.5)+
scale_x_date(date_breaks = "10 years", date_labels = "%Y", limits=c(ym("1949 01"), ym("2021 12")))+
labs(title="r - g (en %/an)"))
(gecartc <- ggplot(HPDD |> filter(year>=1949))+
geom_step(data=~filter(.x,year<1987),aes(x=time, y=100*ec), color="dodgerblue4", direction="mid")+
geom_step(data=~filter(.x,year>=1987),aes(x=time, y=100*ec), color="dodgerblue1", direction="mid")+
geom_col(aes(x=time, y=100*ec_p), fill="red", alpha=0.1, col=NA, width=years(1)/days(1),)+
geom_col(aes(x=time, y=100*ec_m), fill="green", alpha=0.1, width=years(1)/days(1), col=NA)+
geom_segment(aes(y=0, yend=0, x=ym("1949 01"), xend=ym("1986 01")), size=0.1, col="grey25")+
geom_segment(aes(y=0, yend=0.1, x=ym("1949 01"), xend=ym("1949 01")), size=0.1, col="grey25")+
geom_segment(aes(y=0, yend=0.1, x=ym("1986 01"), xend=ym("1986 01")), size=0.1, col="grey25")+
annotate(geom="text", y=0.1, x=ym("1949 2"), label = "CN 2020 INSEE et CGEDD J.Friggit", hjust=0, vjust = 0, size=1.5)+
geom_segment(aes(y=0, yend=0, x=ym("1987 01"), xend=ym("2020 01")), size=0.1, col="grey25")+
geom_segment(aes(y=0, yend=.1, x=ym("1987 01"), xend=ym("1987 01")), size=0.1, col="grey25")+
geom_segment(aes(y=0, yend=.1, x=ym("2020 01"), xend=ym("2020 01")), size=0.1, col="grey25")+
annotate(geom="text", y=-0.1, x=ym("1988 2"), label = "CN 2020 INSEE", hjust=0, vjust = 1, size=1.5)+
scale_x_date(breaks = c(1949, seq(1960, 2010, 10), 2021), date_labels = "%Y", limits=c(ym("1949 01"), ym("2021 12")))+
labs(title="r - g (en %/an)"))
(gecartc <- ggplot(HPDD |> filter(year>=1949))+
geom_step(data=~filter(.x,year<1987),aes(x=time, y=100*ec), color="dodgerblue4", direction="mid")+
geom_step(data=~filter(.x,year>=1987),aes(x=time, y=100*ec), color="dodgerblue1", direction="mid")+
geom_col(aes(x=time, y=100*ec_p), fill="red", alpha=0.1, col=NA, width=years(1)/days(1),)+
geom_col(aes(x=time, y=100*ec_m), fill="green", alpha=0.1, width=years(1)/days(1), col=NA)+
geom_segment(aes(y=0, yend=0, x=ym("1949 01"), xend=ym("1986 01")), size=0.1, col="grey25")+
geom_segment(aes(y=0, yend=0.1, x=ym("1949 01"), xend=ym("1949 01")), size=0.1, col="grey25")+
geom_segment(aes(y=0, yend=0.1, x=ym("1986 01"), xend=ym("1986 01")), size=0.1, col="grey25")+
annotate(geom="text", y=0.1, x=ym("1949 2"), label = "CN 2020 INSEE et CGEDD J.Friggit", hjust=0, vjust = 0, size=1.5)+
geom_segment(aes(y=0, yend=0, x=ym("1987 01"), xend=ym("2020 01")), size=0.1, col="grey25")+
geom_segment(aes(y=0, yend=.1, x=ym("1987 01"), xend=ym("1987 01")), size=0.1, col="grey25")+
geom_segment(aes(y=0, yend=.1, x=ym("2020 01"), xend=ym("2020 01")), size=0.1, col="grey25")+
annotate(geom="text", y=-0.1, x=ym("1988 2"), label = "CN 2020 INSEE", hjust=0, vjust = 1, size=1.5)+
scale_x_date(breaks = days(1)*c(1949, seq(1960, 2010, 10), 2021), date_labels = "%Y", limits=c(ym("1949 01"), ym("2021 12")))+
labs(title="r - g (en %/an)"))
str_c(c(1949, seq(1960, 2010, 10), 2021), " 01")
ym(str_c(c(1949, seq(1960, 2010, 10), 2021), " 01"))
(gecartc <- ggplot(HPDD |> filter(year>=1949))+
geom_step(data=~filter(.x,year<1987),aes(x=time, y=100*ec), color="dodgerblue4", direction="mid")+
geom_step(data=~filter(.x,year>=1987),aes(x=time, y=100*ec), color="dodgerblue1", direction="mid")+
geom_col(aes(x=time, y=100*ec_p), fill="red", alpha=0.1, col=NA, width=years(1)/days(1),)+
geom_col(aes(x=time, y=100*ec_m), fill="green", alpha=0.1, width=years(1)/days(1), col=NA)+
geom_segment(aes(y=0, yend=0, x=ym("1949 01"), xend=ym("1986 01")), size=0.1, col="grey25")+
geom_segment(aes(y=0, yend=0.1, x=ym("1949 01"), xend=ym("1949 01")), size=0.1, col="grey25")+
geom_segment(aes(y=0, yend=0.1, x=ym("1986 01"), xend=ym("1986 01")), size=0.1, col="grey25")+
annotate(geom="text", y=0.1, x=ym("1949 2"), label = "CN 2020 INSEE et CGEDD J.Friggit", hjust=0, vjust = 0, size=1.5)+
geom_segment(aes(y=0, yend=0, x=ym("1987 01"), xend=ym("2020 01")), size=0.1, col="grey25")+
geom_segment(aes(y=0, yend=.1, x=ym("1987 01"), xend=ym("1987 01")), size=0.1, col="grey25")+
geom_segment(aes(y=0, yend=.1, x=ym("2020 01"), xend=ym("2020 01")), size=0.1, col="grey25")+
annotate(geom="text", y=-0.1, x=ym("1988 2"), label = "CN 2020 INSEE", hjust=0, vjust = 1, size=1.5)+
scale_x_date(breaks = ym(str_c(c(1949, seq(1960, 2010, 10), 2021), " 01")), date_labels = "%Y", limits=c(ym("1949 01"), ym("2021 12")))+
labs(title="r - g (en %/an)"))
HPDD
HPDD |> filter(year>1949)
(gecartc <- ggplot(HPDD |> filter(year>=1949))+
geom_step(data=~filter(.x,year<1987),aes(x=time, y=100*ec), color="dodgerblue4", direction="mid")+
geom_step(data=~filter(.x,year>=1987),aes(x=time, y=100*ec), color="dodgerblue1", direction="mid")+
geom_col(aes(x=time, y=100*ec_p), fill="red", alpha=0.1, col=NA, width=years(1)/days(1),)+
geom_col(aes(x=time, y=100*ec_m), fill="green", alpha=0.1, width=years(1)/days(1), col=NA)+
geom_segment(aes(y=0, yend=0, x=ym("1949 01"), xend=ym("1986 01")), size=0.1, col="grey25")+
geom_segment(aes(y=0, yend=0.1, x=ym("1949 01"), xend=ym("1949 01")), size=0.1, col="grey25")+
geom_segment(aes(y=0, yend=0.1, x=ym("1986 01"), xend=ym("1986 01")), size=0.1, col="grey25")+
annotate(geom="text", y=0.1, x=ym("1949 2"), label = "CN 2020 INSEE et CGEDD J.Friggit", hjust=0, vjust = 0, size=1.5)+
geom_segment(aes(y=0, yend=0, x=ym("1987 01"), xend=ym("2020 01")), size=0.1, col="grey25")+
geom_segment(aes(y=0, yend=.1, x=ym("1987 01"), xend=ym("1987 01")), size=0.1, col="grey25")+
geom_segment(aes(y=0, yend=.1, x=ym("2020 01"), xend=ym("2020 01")), size=0.1, col="grey25")+
annotate(geom="text", y=-0.1, x=ym("1988 2"), label = "CN 2020 INSEE", hjust=0, vjust = 1, size=1.5)+
scale_x_date(breaks = ym(str_c(c(1949, seq(1950, 2010, 10), 2021), " 01")), date_labels = "%Y", limits=c(ym("1949 01"), ym("2021 12")))+
labs(title="r - g (en %/an)"))
(gecartc <- ggplot(HPDD |> filter(year>=1949))+
geom_step(data=~filter(.x,year<1987),aes(x=time, y=100*ec), color="dodgerblue4", direction="mid")+
geom_step(data=~filter(.x,year>=1987),aes(x=time, y=100*ec), color="dodgerblue1", direction="mid")+
geom_col(aes(x=time, y=100*ec_p), fill="red", alpha=0.1, col=NA, width=years(1)/days(1),)+
geom_col(aes(x=time, y=100*ec_m), fill="green", alpha=0.1, width=years(1)/days(1), col=NA)+
geom_segment(aes(y=0, yend=0, x=ym("1949 01"), xend=ym("1986 01")), size=0.1, col="grey25")+
geom_segment(aes(y=0, yend=0.1, x=ym("1949 01"), xend=ym("1949 01")), size=0.1, col="grey25")+
geom_segment(aes(y=0, yend=0.1, x=ym("1986 01"), xend=ym("1986 01")), size=0.1, col="grey25")+
annotate(geom="text", y=0.1, x=ym("1949 2"), label = "CN 2020 INSEE et CGEDD J.Friggit", hjust=0, vjust = 0, size=1.5)+
geom_segment(aes(y=0, yend=0, x=ym("1987 01"), xend=ym("2020 01")), size=0.1, col="grey25")+
geom_segment(aes(y=0, yend=.1, x=ym("1987 01"), xend=ym("1987 01")), size=0.1, col="grey25")+
geom_segment(aes(y=0, yend=.1, x=ym("2020 01"), xend=ym("2020 01")), size=0.1, col="grey25")+
annotate(geom="text", y=-0.1, x=ym("1988 2"), label = "CN 2020 INSEE", hjust=0, vjust = 1, size=1.5)+
scale_x_date(breaks = ym(str_c(c(1949, seq(1960, 2010, 10), 2021), " 01")), date_labels = "%Y", limits=c(ym("1949 01"), ym("2021 12")))+
labs(title="r - g (en %/an)"))
HPDD |> filter(year>1949)
HPDD |> filter(year>1949) |> select(time, ec)
(gecartc <- ggplot(HPDD |> filter(year>=1949))+
geom_step(data=~filter(.x,year<1987),aes(x=time, y=100*ec), color="dodgerblue4", direction="mid")+
geom_step(data=~filter(.x,year>=1987),aes(x=time, y=100*ec), color="dodgerblue1", direction="mid")+
geom_col(aes(x=time, y=100*ec_p), fill="red", alpha=0.1, col=NA, width=years(1)/days(1),)+
geom_col(aes(x=time, y=100*ec_m), fill="green", alpha=0.1, width=years(1)/days(1), col=NA)+
geom_segment(aes(y=0, yend=0, x=ym("1949 01"), xend=ym("1986 01")), size=0.1, col="grey25")+
geom_segment(aes(y=0, yend=0.1, x=ym("1949 01"), xend=ym("1949 01")), size=0.1, col="grey25")+
geom_segment(aes(y=0, yend=0.1, x=ym("1986 01"), xend=ym("1986 01")), size=0.1, col="grey25")+
annotate(geom="text", y=0.1, x=ym("1949 2"), label = "CN 2020 INSEE et CGEDD J.Friggit", hjust=0, vjust = 0, size=1.5)+
geom_segment(aes(y=0, yend=0, x=ym("1987 01"), xend=ym("2020 01")), size=0.1, col="grey25")+
geom_segment(aes(y=0, yend=.1, x=ym("1987 01"), xend=ym("1987 01")), size=0.1, col="grey25")+
geom_segment(aes(y=0, yend=.1, x=ym("2020 01"), xend=ym("2020 01")), size=0.1, col="grey25")+
annotate(geom="text", y=-0.1, x=ym("1988 2"), label = "CN 2020 INSEE", hjust=0, vjust = 1, size=1.5)+
scale_x_date(breaks = ym(str_c(c(1955, seq(1960, 2010, 10), 2021), " 01")), date_labels = "%Y", limits=c(ym("1949 01"), ym("2021 12")))+
labs(title="r - g (en %/an)"))
gcharge <- ggplot(interets)+
geom_step(aes(x=time, y=100*verses), col="dodgerblue1", direction="mid")+
geom_segment(aes(y=0, yend=0, x=ym("1949 01"), xend=ym("2020 12")), size=0.1, col="grey25")+
geom_segment(aes(y=0, yend=0.05, x=ym("1949 01"), xend=ym("1949 01")), size=0.1, col="grey25")+
geom_segment(aes(y=0, yend=0.05, x=ym("2020 12"), xend=ym("2020 12")), size=0.1, col="grey25")+
annotate(geom="text", y=0.05, x=ym("1949 2"), label = "CN 2020 INSEE", hjust=0, vjust = 0, size=1.5)+
scale_x_date(breaks = ym(str_c(c(1955, seq(1960, 2010, 10), 2021), " 01")), date_labels = "%Y", limits=c(ym("1949 01"), ym("2021 12")))+
ylim(c(0,4))+
labs(title="Charge d'intérêts en % du PIB")
gcharge
gcharge <- ggplot(interets)+
geom_step(aes(x=time, y=100*verses), col="dodgerblue1", direction="mid")+
geom_segment(aes(y=0, yend=0, x=ym("1949 01"), xend=ym("2020 12")), size=0.1, col="grey25")+
geom_segment(aes(y=0, yend=0.05, x=ym("1949 01"), xend=ym("1949 01")), size=0.1, col="grey25")+
geom_segment(aes(y=0, yend=0.05, x=ym("2020 12"), xend=ym("2020 12")), size=0.1, col="grey25")+
annotate(geom="text", y=0.05, x=ym("1949 2"), label = "CN 2020 INSEE", hjust=0, vjust = 0, size=1.5)+
scale_x_date(breaks = ym(str_c(c(1949, seq(1960, 2010, 10), 2021), " 01")), date_labels = "%Y", limits=c(ym("1949 01"), ym("2021 12")))+
ylim(c(0,4))+
labs(title="Charge d'intérêts en % du PIB")
gcharge <- ggplot(interets)+
geom_step(aes(x=time, y=100*verses), col="dodgerblue1", direction="mid")+
geom_segment(aes(y=0, yend=0, x=ym("1949 01"), xend=ym("2020 12")), size=0.1, col="grey25")+
geom_segment(aes(y=0, yend=0.05, x=ym("1949 01"), xend=ym("1949 01")), size=0.1, col="grey25")+
geom_segment(aes(y=0, yend=0.05, x=ym("2020 12"), xend=ym("2020 12")), size=0.1, col="grey25")+
annotate(geom="text", y=0.05, x=ym("1949 2"), label = "CN 2020 INSEE", hjust=0, vjust = 0, size=1.5)+
scale_x_date(breaks = ym(str_c(c(1949, seq(1960, 2010, 10), 2021), " 01")), date_labels = "%Y", limits=c(ym("1949 01"), ym("2020 12")))+
ylim(c(0,4))+
labs(title="Charge d'intérêts en % du PIB")
1
(gecartc <- ggplot(HPDD |> filter(year>=1949))+
geom_step(data=~filter(.x,year<1987),aes(x=time, y=100*ec), color="dodgerblue4", direction="mid")+
geom_step(data=~filter(.x,year>=1987),aes(x=time, y=100*ec), color="dodgerblue1", direction="mid")+
geom_col(aes(x=time, y=100*ec_p), fill="red", alpha=0.1, col=NA, width=years(1)/days(1),)+
geom_col(aes(x=time, y=100*ec_m), fill="green", alpha=0.1, width=years(1)/days(1), col=NA)+
geom_segment(aes(y=0, yend=0, x=ym("1949 01"), xend=ym("1986 01")), size=0.1, col="grey25")+
geom_segment(aes(y=0, yend=0.1, x=ym("1949 01"), xend=ym("1949 01")), size=0.1, col="grey25")+
geom_segment(aes(y=0, yend=0.1, x=ym("1986 01"), xend=ym("1986 01")), size=0.1, col="grey25")+
annotate(geom="text", y=0.1, x=ym("1949 2"), label = "CN 2020 INSEE et CGEDD J.Friggit", hjust=0, vjust = 0, size=1.5)+
geom_segment(aes(y=0, yend=0, x=ym("1987 01"), xend=ym("2020 01")), size=0.1, col="grey25")+
geom_segment(aes(y=0, yend=.1, x=ym("1987 01"), xend=ym("1987 01")), size=0.1, col="grey25")+
geom_segment(aes(y=0, yend=.1, x=ym("2020 01"), xend=ym("2020 01")), size=0.1, col="grey25")+
annotate(geom="text", y=-0.1, x=ym("1988 2"), label = "CN 2020 INSEE", hjust=0, vjust = 1, size=1.5)+
scale_x_date(breaks = ym(str_c(c(1955, seq(1960, 2010, 10), 2021), " 01")), date_labels = "%Y", limits=c(ym("1949 01"), ym("2020 12")))+
labs(title="r - g (en %/an)"))
gtaux <- ggplot(taux |> filter(y>=1949))+
geom_step(data=~filter(.x, y>= 1987), aes(x=time, y=r10ans), col="dodgerblue1", direction="mid")+
geom_step(data=~filter(.x, y<1987),aes(x=time, y=r_frig), col="dodgerblue4", direction="mid")+
geom_segment(aes(y=0, yend=0, x=ym("1949 01"), xend=ym("1987 01")), size=0.1, col="grey25")+
geom_segment(aes(y=0, yend=0.1, x=ym("1949 01"), xend=ym("1949 01")), size=0.1, col="grey25")+
geom_segment(aes(y=0, yend=0.1, x=ym("1987 01"), xend=ym("1987 01")), size=0.1, col="grey25")+
annotate(geom="text", y=0.1, x=ym("1949 2"), label = "CN 2020 INSEE et CGEDD J.Friggit", hjust=0, vjust = 0, size=1.5)+
geom_segment(aes(y=0, yend=0, x=ym("1987 01"), xend=ym("2021 11")), size=0.1, col="grey25")+
geom_segment(aes(y=0, yend=.1, x=ym("1987 01"), xend=ym("1987 01")), size=0.1, col="grey25")+
geom_segment(aes(y=0, yend=.1, x=ym("2021 11"), xend=ym("2021 11")), size=0.1, col="grey25")+
annotate(geom="text", y=0.1, x=ym("1988 2"), label = "CN 2020 INSEE", hjust=0, vjust = 0, size=1.5)+
scale_x_date(breaks = ym(str_c(c(1955, seq(1960, 2010, 10), 2021), " 01")), date_labels = "%Y", limits=c(ym("1949 01"), ym("2021 12")))+
labs(title="Taux souverain (10 ans, en %/an)")
gtaux
gtaux <- ggplot(taux |> filter(y>=1949))+
geom_step(data=~filter(.x, y>= 1987), aes(x=time, y=r10ans), col="dodgerblue1", direction="mid")+
geom_step(data=~filter(.x, y<1987),aes(x=time, y=r_frig), col="dodgerblue4", direction="mid")+
geom_segment(aes(y=0, yend=0, x=ym("1949 01"), xend=ym("1987 01")), size=0.1, col="grey25")+
geom_segment(aes(y=0, yend=0.1, x=ym("1949 01"), xend=ym("1949 01")), size=0.1, col="grey25")+
geom_segment(aes(y=0, yend=0.1, x=ym("1987 01"), xend=ym("1987 01")), size=0.1, col="grey25")+
annotate(geom="text", y=0.1, x=ym("1949 2"), label = "CN 2020 INSEE et CGEDD J.Friggit", hjust=0, vjust = 0, size=1.5)+
geom_segment(aes(y=0, yend=0, x=ym("1987 01"), xend=ym("2021 11")), size=0.1, col="grey25")+
geom_segment(aes(y=0, yend=.1, x=ym("1987 01"), xend=ym("1987 01")), size=0.1, col="grey25")+
geom_segment(aes(y=0, yend=.1, x=ym("2021 11"), xend=ym("2021 11")), size=0.1, col="grey25")+
annotate(geom="text", y=0.1, x=ym("1988 2"), label = "CN 2020 INSEE", hjust=0, vjust = 0, size=1.5)+
scale_x_date(breaks = ym(str_c(c(1949, seq(1960, 2010, 10), 2021), " 01")), date_labels = "%Y", limits=c(ym("1949 01"), ym("2021 12")))+
labs(title="Taux souverain (10 ans, en %/an)")
gtaux
gdette <- ggplot(HPDD |> filter(year>=1949))+
geom_step(data=~filter(.x,year<1978),aes(x=time, y=dette_IMF), color="dodgerblue4", direction="mid")+
geom_step(aes(x=time, y=dette), col="dodgerblue1", direction="mid")+
ylim(c(0,120))+
geom_segment(aes(y=0, yend=0, x=ym("1949 01"), xend=ym("1977 01")), size=0.1, col="grey25")+
geom_segment(aes(y=0, yend=1, x=ym("1949 01"), xend=ym("1949 01")), size=0.1, col="grey25")+
geom_segment(aes(y=0, yend=1, x=ym("1977 01"), xend=ym("1977 01")), size=0.1, col="grey25")+
annotate(geom="text", y=1, x=ym("1949 2"), label = "IMF historical public debt database", hjust=0, vjust = 0, size=1.5)+
geom_segment(aes(y=0, yend=0, x=ym("1978 01"), xend=ym("2020 12")), size=0.1, col="grey25")+
geom_segment(aes(y=0, yend=1, x=ym("1978 01"), xend=ym("1978 01")), size=0.1, col="grey25")+
geom_segment(aes(y=0, yend=1, x=ym("2020 12"), xend=ym("2020 12")), size=0.1, col="grey25")+
annotate(geom="text", y=1, x=ym("1978 2"), label = "CN 2020 INSEE", hjust=0, vjust = 0, size=1.5)+
scale_x_date(breaks = ym(str_c(c(1949, seq(1960, 2010, 10), 2021), " 01")), date_labels = "%Y", limits=c(ym("1949 01"), ym("2021 12")))+
labs(title="Dette publique en % du PIB")
gdette
gdette <- ggplot(HPDD |> filter(year>=1949))+
geom_step(data=~filter(.x,year<1978),aes(x=time, y=dette_IMF), color="dodgerblue4", direction="mid")+
geom_step(aes(x=time, y=dette), col="dodgerblue1", direction="mid")+
ylim(c(0,120))+
geom_segment(aes(y=0, yend=0, x=ym("1949 01"), xend=ym("1977 01")), size=0.1, col="grey25")+
geom_segment(aes(y=0, yend=1, x=ym("1949 01"), xend=ym("1949 01")), size=0.1, col="grey25")+
geom_segment(aes(y=0, yend=1, x=ym("1977 01"), xend=ym("1977 01")), size=0.1, col="grey25")+
annotate(geom="text", y=1, x=ym("1949 2"), label = "IMF historical public debt database", hjust=0, vjust = 0, size=1.5)+
geom_segment(aes(y=0, yend=0, x=ym("1978 01"), xend=ym("2020 12")), size=0.1, col="grey25")+
geom_segment(aes(y=0, yend=1, x=ym("1978 01"), xend=ym("1978 01")), size=0.1, col="grey25")+
geom_segment(aes(y=0, yend=1, x=ym("2020 12"), xend=ym("2020 12")), size=0.1, col="grey25")+
annotate(geom="text", y=1, x=ym("1978 2"), label = "CN 2020 INSEE", hjust=0, vjust = 0, size=1.5)+
scale_x_date(breaks = ym(str_c(c(1949, seq(1960, 2010, 10), 2021), " 01")), date_labels = "%Y", limits=c(ym("1949 01"), ym("2021 12")))+
labs(title="Dette publique en % du PIB")
gdette <- ggplot(HPDD |> filter(year>=1949))+
geom_step(data=~filter(.x,year<1978),aes(x=time, y=dette_IMF), color="dodgerblue4", direction="mid")+
geom_step(aes(x=time, y=dette), col="dodgerblue1", direction="mid")+
ylim(c(0,120))+
geom_segment(aes(y=0, yend=0, x=ym("1949 01"), xend=ym("1977 01")), size=0.1, col="grey25")+
geom_segment(aes(y=0, yend=1, x=ym("1949 01"), xend=ym("1949 01")), size=0.1, col="grey25")+
geom_segment(aes(y=0, yend=1, x=ym("1977 01"), xend=ym("1977 01")), size=0.1, col="grey25")+
annotate(geom="text", y=1, x=ym("1949 2"), label = "IMF historical public debt database", hjust=0, vjust = 0, size=1.5)+
geom_segment(aes(y=0, yend=0, x=ym("1978 01"), xend=ym("2020 12")), size=0.1, col="grey25")+
geom_segment(aes(y=0, yend=1, x=ym("1978 01"), xend=ym("1978 01")), size=0.1, col="grey25")+
geom_segment(aes(y=0, yend=1, x=ym("2020 12"), xend=ym("2020 12")), size=0.1, col="grey25")+
annotate(geom="text", y=1, x=ym("1978 2"), label = "CN 2020 INSEE", hjust=0, vjust = 0, size=1.5)+
scale_x_date(breaks = ym(str_c(c(1949, seq(1960, 2010, 10), 2020), " 01")), date_labels = "%Y", limits=c(ym("1949 01"), ym("2021 12")))+
labs(title="Dette publique en % du PIB")
gdette
gdette <- ggplot(HPDD |> filter(year>=1949))+
geom_step(data=~filter(.x,year<1978),aes(x=time, y=dette_IMF), color="dodgerblue4", direction="mid")+
geom_step(aes(x=time, y=dette), col="dodgerblue1", direction="mid")+
ylim(c(0,120))+
geom_segment(aes(y=0, yend=0, x=ym("1949 01"), xend=ym("1977 01")), size=0.1, col="grey25")+
geom_segment(aes(y=0, yend=1, x=ym("1949 01"), xend=ym("1949 01")), size=0.1, col="grey25")+
geom_segment(aes(y=0, yend=1, x=ym("1977 01"), xend=ym("1977 01")), size=0.1, col="grey25")+
annotate(geom="text", y=1, x=ym("1949 2"), label = "IMF historical public debt database", hjust=0, vjust = 0, size=1.5)+
geom_segment(aes(y=0, yend=0, x=ym("1978 01"), xend=ym("2020 06")), size=0.1, col="grey25")+
geom_segment(aes(y=0, yend=1, x=ym("1978 01"), xend=ym("1978 01")), size=0.1, col="grey25")+
geom_segment(aes(y=0, yend=1, x=ym("2020 06"), xend=ym("2020 06")), size=0.1, col="grey25")+
annotate(geom="text", y=1, x=ym("1978 2"), label = "CN 2020 INSEE", hjust=0, vjust = 0, size=1.5)+
scale_x_date(breaks = ym(str_c(c(1949, seq(1960, 2010, 10), 2020), " 01")), date_labels = "%Y", limits=c(ym("1949 01"), ym("2021 12")))+
labs(title="Dette publique en % du PIB")
gdette
gtaux <- ggplot(taux |> filter(y>=1949))+
geom_step(data=~filter(.x, y>= 1987), aes(x=time, y=r10ans), col="dodgerblue1", direction="mid")+
geom_step(data=~filter(.x, y<1987),aes(x=time, y=r_frig), col="dodgerblue4", direction="mid")+
geom_segment(aes(y=0, yend=0, x=ym("1949 01"), xend=ym("1987 01")), size=0.1, col="grey25")+
geom_segment(aes(y=0, yend=0.1, x=ym("1949 01"), xend=ym("1949 01")), size=0.1, col="grey25")+
geom_segment(aes(y=0, yend=0.1, x=ym("1987 01"), xend=ym("1987 01")), size=0.1, col="grey25")+
annotate(geom="text", y=0.1, x=ym("1949 2"), label = "CN 2020 INSEE et CGEDD J.Friggit", hjust=0, vjust = 0, size=1.5)+
geom_segment(aes(y=0, yend=0, x=ym("1987 01"), xend=ym("2021 11")), size=0.1, col="grey25")+
geom_segment(aes(y=0, yend=.1, x=ym("1987 01"), xend=ym("1987 01")), size=0.1, col="grey25")+
geom_segment(aes(y=0, yend=.1, x=ym("2021 11"), xend=ym("2021 11")), size=0.1, col="grey25")+
annotate(geom="text", y=0.1, x=ym("1988 2"), label = "CN 2020 INSEE", hjust=0, vjust = 0, size=1.5)+
scale_x_date(breaks = ym(str_c(c(1949, seq(1960, 2010, 10), 2021), " 01")), date_labels = "%Y", limits=c(ym("1949 01"), ym("2021 12")))+
labs(title="Taux souverain (10 ans, en %/an)")
gtaux
gcharge <- ggplot(interets)+
geom_step(aes(x=time, y=100*verses), col="dodgerblue1", direction="mid")+
geom_segment(aes(y=0, yend=0, x=ym("1949 01"), xend=ym("2020 12")), size=0.1, col="grey25")+
geom_segment(aes(y=0, yend=0.05, x=ym("1949 01"), xend=ym("1949 01")), size=0.1, col="grey25")+
geom_segment(aes(y=0, yend=0.05, x=ym("2020 12"), xend=ym("2020 12")), size=0.1, col="grey25")+
annotate(geom="text", y=0.05, x=ym("1949 2"), label = "CN 2020 INSEE", hjust=0, vjust = 0, size=1.5)+
scale_x_date(breaks = ym(str_c(c(1949, seq(1960, 2010, 10), 2020), " 01")), date_labels = "%Y", limits=c(ym("1949 01"), ym("2021 12")))+
ylim(c(0,4))+
labs(title="Charge d'intérêts en % du PIB")
gcharge
gcharge <- ggplot(interets)+
geom_step(aes(x=time, y=100*verses), col="dodgerblue1", direction="mid")+
geom_segment(aes(y=0, yend=0, x=ym("1949 01"), xend=ym("2020 06")), size=0.1, col="grey25")+
geom_segment(aes(y=0, yend=0.05, x=ym("1949 01"), xend=ym("1949 01")), size=0.1, col="grey25")+
geom_segment(aes(y=0, yend=0.05, x=ym("2020 12"), xend=ym("2020 06")), size=0.1, col="grey25")+
annotate(geom="text", y=0.05, x=ym("1949 2"), label = "CN 2020 INSEE", hjust=0, vjust = 0, size=1.5)+
scale_x_date(breaks = ym(str_c(c(1949, seq(1960, 2010, 10), 2020), " 01")), date_labels = "%Y", limits=c(ym("1949 01"), ym("2021 12")))+
ylim(c(0,4))+
labs(title="Charge d'intérêts en % du PIB")
gcharge
gcharge <- ggplot(interets)+
geom_step(aes(x=time, y=100*verses), col="dodgerblue1", direction="mid")+
geom_segment(aes(y=0, yend=0, x=ym("1949 01"), xend=ym("2020 06")), size=0.1, col="grey25")+
geom_segment(aes(y=0, yend=0.05, x=ym("1949 01"), xend=ym("1949 01")), size=0.1, col="grey25")+
geom_segment(aes(y=0, yend=0.05, x=ym("2020 06"), xend=ym("2020 06")), size=0.1, col="grey25")+
annotate(geom="text", y=0.05, x=ym("1949 2"), label = "CN 2020 INSEE", hjust=0, vjust = 0, size=1.5)+
scale_x_date(breaks = ym(str_c(c(1949, seq(1960, 2010, 10), 2020), " 01")), date_labels = "%Y", limits=c(ym("1949 01"), ym("2021 12")))+
ylim(c(0,4))+
labs(title="Charge d'intérêts en % du PIB")
gcharge
(gecartc <- ggplot(HPDD |> filter(year>=1949))+
geom_step(data=~filter(.x,year<1987),aes(x=time, y=100*ec), color="dodgerblue4", direction="mid")+
geom_step(data=~filter(.x,year>=1987),aes(x=time, y=100*ec), color="dodgerblue1", direction="mid")+
geom_col(aes(x=time, y=100*ec_p), fill="red", alpha=0.1, col=NA, width=years(1)/days(1),)+
geom_col(aes(x=time, y=100*ec_m), fill="green", alpha=0.1, width=years(1)/days(1), col=NA)+
geom_segment(aes(y=0, yend=0, x=ym("1949 01"), xend=ym("1986 01")), size=0.1, col="grey25")+
geom_segment(aes(y=0, yend=0.1, x=ym("1949 01"), xend=ym("1949 01")), size=0.1, col="grey25")+
geom_segment(aes(y=0, yend=0.1, x=ym("1986 01"), xend=ym("1986 01")), size=0.1, col="grey25")+
annotate(geom="text", y=0.1, x=ym("1949 2"), label = "CN 2020 INSEE et CGEDD J.Friggit", hjust=0, vjust = 0, size=1.5)+
geom_segment(aes(y=0, yend=0, x=ym("1987 01"), xend=ym("2020 01")), size=0.1, col="grey25")+
geom_segment(aes(y=0, yend=.1, x=ym("1987 01"), xend=ym("1987 01")), size=0.1, col="grey25")+
geom_segment(aes(y=0, yend=.1, x=ym("2020 01"), xend=ym("2020 01")), size=0.1, col="grey25")+
annotate(geom="text", y=-0.1, x=ym("1988 2"), label = "CN 2020 INSEE", hjust=0, vjust = 1, size=1.5)+
scale_x_date(breaks = ym(str_c(c(1955, seq(1960, 2010, 10), 2020), " 01")), date_labels = "%Y", limits=c(ym("1949 01"), ym("2021 12")))+
labs(title="r - g (en %/an)"))
g_altereco <- (gdette + gtaux)/(gecartc+gcharge) +
plot_annotation(caption="Sources: INSEE, Banque de France, FMI, J. Friggit/CGEDD \n code: github.com/OFCE/AE_11-21") &
ylab("") &
xlab("") &
theme_minimal(base_family = "sans") &
scale_x_date(date_breaks = "10 years", date_labels = "%Y", limits=c(ym("1949 01"), ym("2021 12"))) &
theme(plot.title = element_text(size=10, face = "plain", hjust = 0.5),
plot.caption = element_text(size=7, face = "plain", hjust = 0),
axis.text =  element_text(size=7),
panel.grid.major = element_line(color="grey90", size=0.25),
panel.grid.minor = element_line(color="grey90", size=0.25))
g_altereco
g_altereco <- (gdette + gtaux)/(gecartc+gcharge) +
plot_annotation(caption="Sources: INSEE, Banque de France, FMI, J. Friggit/CGEDD \n code: github.com/OFCE/AE_11-21") &
ylab("") &
xlab("") &
theme_minimal(base_family = "sans") &
theme(plot.title = element_text(size=10, face = "plain", hjust = 0.5),
plot.caption = element_text(size=7, face = "plain", hjust = 0),
axis.text =  element_text(size=7),
panel.grid.major = element_line(color="grey90", size=0.25),
panel.grid.minor = element_line(color="grey90", size=0.25))
g_altereco
(gecartc <- ggplot(HPDD |> filter(year>=1949))+
geom_step(data=~filter(.x,year<1987),aes(x=time, y=100*ec), color="dodgerblue4", direction="mid")+
geom_step(data=~filter(.x,year>=1987),aes(x=time, y=100*ec), color="dodgerblue1", direction="mid")+
geom_col(aes(x=time, y=100*ec_p), fill="red", alpha=0.1, col=NA, width=years(1)/days(1),)+
geom_col(aes(x=time, y=100*ec_m), fill="green", alpha=0.1, width=years(1)/days(1), col=NA)+
geom_segment(aes(y=0, yend=0, x=ym("1955 01"), xend=ym("1986 01")), size=0.1, col="grey25")+
geom_segment(aes(y=0, yend=0.1, x=ym("1955 01"), xend=ym("1955 01")), size=0.1, col="grey25")+
geom_segment(aes(y=0, yend=0.1, x=ym("1986 01"), xend=ym("1986 01")), size=0.1, col="grey25")+
annotate(geom="text", y=0.1, x=ym("1949 2"), label = "CN 2020 INSEE et CGEDD J.Friggit", hjust=0, vjust = 0, size=1.5)+
geom_segment(aes(y=0, yend=0, x=ym("1987 01"), xend=ym("2020 01")), size=0.1, col="grey25")+
geom_segment(aes(y=0, yend=.1, x=ym("1987 01"), xend=ym("1987 01")), size=0.1, col="grey25")+
geom_segment(aes(y=0, yend=.1, x=ym("2020 01"), xend=ym("2020 01")), size=0.1, col="grey25")+
annotate(geom="text", y=-0.1, x=ym("1988 2"), label = "CN 2020 INSEE", hjust=0, vjust = 1, size=1.5)+
scale_x_date(breaks = ym(str_c(c(1955, seq(1960, 2010, 10), 2020), " 01")), date_labels = "%Y", limits=c(ym("1949 01"), ym("2021 12")))+
labs(title="r - g (en %/an)"))
g_altereco <- (gdette + gtaux)/(gecartc+gcharge) +
plot_annotation(caption="Sources: INSEE, Banque de France, FMI, J. Friggit/CGEDD \n code: github.com/OFCE/AE_11-21") &
ylab("") &
xlab("") &
theme_minimal(base_family = "sans") &
theme(plot.title = element_text(size=10, face = "plain", hjust = 0.5),
plot.caption = element_text(size=7, face = "plain", hjust = 0),
axis.text =  element_text(size=7),
panel.grid.major = element_line(color="grey90", size=0.25),
panel.grid.minor = element_line(color="grey90", size=0.25))
ggsave(plot=g_altereco, filename="altereco.svg", width = 180, height = 180, units = "mm")
g_altereco <- (gdette + gtaux)/(gecartc+gcharge) +
plot_annotation(caption="Sources: INSEE, Banque de France, FMI, J. Friggit/CGEDD \n code: github.com/OFCE/AE_11-21") &
ylab("") &
xlab("") &
theme_minimal(base_family = "sans") &
theme(plot.title = element_text(size=10, face = "plain", hjust = 0.5),
plot.caption = element_text(size=7, face = "plain", hjust = 0),
axis.text =  element_text(size=6),
panel.grid.major = element_line(color="grey90", size=0.25),
panel.grid.minor = element_line(color="grey90", size=0.25))
ggsave(plot=g_altereco, filename="altereco.svg", width = 180, height = 180, units = "mm")
(gecartc <- ggplot(HPDD |> filter(year>=1949))+
geom_step(data=~filter(.x,year<1987),aes(x=time, y=100*ec), color="dodgerblue4", direction="mid")+
geom_step(data=~filter(.x,year>=1987),aes(x=time, y=100*ec), color="dodgerblue1", direction="mid")+
geom_col(aes(x=time, y=100*ec_p), fill="red", alpha=0.1, col=NA, width=years(1)/days(1),)+
geom_col(aes(x=time, y=100*ec_m), fill="green", alpha=0.1, width=years(1)/days(1), col=NA)+
geom_segment(aes(y=0, yend=0, x=ym("1955 01"), xend=ym("1986 01")), size=0.1, col="grey25")+
geom_segment(aes(y=0, yend=0.1, x=ym("1955 01"), xend=ym("1955 01")), size=0.1, col="grey25")+
geom_segment(aes(y=0, yend=0.1, x=ym("1986 01"), xend=ym("1986 01")), size=0.1, col="grey25")+
annotate(geom="text", y=0.1, x=ym("1955 2"), label = "CN 2020 INSEE/CGEDD", hjust=0, vjust = 0, size=1.5)+
geom_segment(aes(y=0, yend=0, x=ym("1987 01"), xend=ym("2020 01")), size=0.1, col="grey25")+
geom_segment(aes(y=0, yend=.1, x=ym("1987 01"), xend=ym("1987 01")), size=0.1, col="grey25")+
geom_segment(aes(y=0, yend=.1, x=ym("2020 01"), xend=ym("2020 01")), size=0.1, col="grey25")+
annotate(geom="text", y=-0.1, x=ym("1988 2"), label = "CN 2020 INSEE", hjust=0, vjust = 1, size=1.5)+
scale_x_date(breaks = ym(str_c(c(1955, seq(1960, 2010, 10), 2020), " 01")), date_labels = "%Y", limits=c(ym("1949 01"), ym("2021 12")))+
labs(title="r - g (en %/an)"))
g_altereco <- (gdette + gtaux)/(gecartc+gcharge) +
plot_annotation(caption="Sources: INSEE, Banque de France, FMI, J. Friggit/CGEDD \n code: github.com/OFCE/AE_11-21") &
ylab("") &
xlab("") &
theme_minimal(base_family = "sans") &
theme(plot.title = element_text(size=10, face = "plain", hjust = 0.5),
plot.caption = element_text(size=7, face = "plain", hjust = 0),
axis.text =  element_text(size=6),
panel.grid.major = element_line(color="grey90", size=0.25),
panel.grid.minor = element_line(color="grey90", size=0.25))
g_altereco
ggsave(plot=g_altereco, filename="altereco.svg", width = 180, height = 180, units = "mm")
